(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6954:function(e,t,a){Promise.resolve().then(a.bind(a,503)),Promise.resolve().then(a.bind(a,1523)),Promise.resolve().then(a.bind(a,49))},503:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var r=a(7437),s=a(2265),n=a(3145),i=a(1666);function o(e){let{variant:t="primary",size:a="md",isLoading:s=!1,leftIcon:n,rightIcon:i,children:o,className:d="",disabled:c,...m}=e,h="".concat("inline-flex items-center justify-center gap-2 font-semibold rounded-lg transition-all duration-200 ease-in-out transform focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-primary/70 focus-visible:ring-offset-2"," ").concat({primary:"bg-brand-primary text-text-inverted shadow-brand-primary border border-brand-primary/20 hover:shadow-brand-primary-hover hover:-translate-y-[1px] active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:translate-y-0 disabled:hover:shadow-brand-primary",secondary:"bg-bg-2 text-text-primary shadow-workspace border border-border-primary hover:bg-bg-4 hover:-translate-y-[1px] active:translate-y-0",outline:"bg-bg-3 border border-border-primary text-text-primary hover:border-brand-primary hover:text-text-primary active:translate-y-0",ghost:"bg-transparent text-text-secondary hover:bg-bg-2 active:scale-95"}[t]," ").concat({sm:"h-9 px-4 text-sm",md:"h-10 px-6 text-sm",lg:"h-11 px-8 text-base"}[a]," ").concat(d);return(0,r.jsx)("button",{className:h,disabled:c||s,...m,children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l,{size:a}),(0,r.jsx)("span",{children:"Loading..."})]}):(0,r.jsxs)(r.Fragment,{children:[n,o,i]})})}function l(e){let{size:t}=e;return(0,r.jsxs)("svg",{className:"animate-spin ".concat({sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[t]," text-current"),fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}function d(e){let{children:t,className:a="",variant:s="default",padding:n="md"}=e;return(0,r.jsx)("div",{className:"".concat("rounded-md transition-all duration-200 ease-in-out"," ").concat({default:"bg-bg-4 comic-border-thick comic-shadow hover:shadow-xl hover:-translate-y-1",elevated:"bg-bg-3 comic-border-thick comic-shadow-lg hover:shadow-2xl hover:-translate-y-1",bordered:"bg-bg-3 border border-border-primary hover:border-border-secondary hover:shadow-lg"}[s]," ").concat({none:"",sm:"p-4",md:"p-6 md:p-8",lg:"p-8 md:p-10"}[n]," ").concat(a),children:t})}function c(){let[e,t]=(0,s.useState)("landing"),[a,o]=(0,s.useState)(null),[l,d]=(0,s.useState)(null),[c,b]=(0,s.useState)(null),[g,j]=(0,s.useState)(0),[w,N]=(0,s.useState)(!1),[k,M]=(0,s.useState)(5),[C,L]=(0,s.useState)(0),W=Math.max(0,5-C),S=(0,s.useRef)(null),A=(0,s.useRef)(null);(0,s.useEffect)(()=>{{let e=i.M6.isInstalled();N(e),e||console.warn("MiniKit not installed - running in development mode")}},[]);let D=(0,s.useCallback)(e=>{switch(e.type){case"queue_status":j(e.payload.position);break;case"matched":let r=e.payload;d({matchedUsername:r.matchedUsername,matchedAt:Date.now()}),t("matched"),_(r.matchedUsername),(null==a?void 0:a.walletAddress)?fetch("/api/matches/increment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet_address:a.walletAddress})}).then(e=>e.json()).then(e=>{"number"==typeof e.count?L(e.count):L(e=>e+1)}).catch(()=>{L(e=>e+1)}):L(e=>e+1);break;case"error":b(e.payload.message),t("error");break;case"heartbeat":var s;null===(s=S.current)||void 0===s||s.send(JSON.stringify({type:"heartbeat"}))}},[]),z=(0,s.useCallback)(r=>{S.current&&S.current.close();let s="https:"===window.location.protocol?"wss:":"ws:",n=window.location.host,i="".concat(s,"//").concat(n);try{let s=new WebSocket("".concat(i,"/ws?username=").concat(encodeURIComponent(r)));S.current=s,s.onopen=()=>{console.log("WebSocket connected"),s.send(JSON.stringify({type:"join_queue",payload:{username:r}})),t("matching")},s.onmessage=e=>{try{let t=JSON.parse(e.data);D(t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},s.onerror=()=>{b("Connection error. Please try again."),t("error")},s.onclose=()=>{"matching"===e&&(A.current=setTimeout(()=>{(null==a?void 0:a.username)&&z(a.username)},3e3))}}catch(e){console.error("Failed to connect WebSocket:",e),b("Failed to connect to matching service."),t("error")}},[e,null==a?void 0:a.username,D]),_=(0,s.useCallback)(e=>{M(5);let t=setInterval(()=>{M(a=>a<=1?(clearInterval(t),P(e),0):a-1)},1e3)},[]),P=(0,s.useCallback)(async e=>{try{i.M6.isInstalled()?await i.M6.commandsAsync.chat({to:[e],message:"Hey! We matched on Mindalike \uD83D\uDC4B"}):(console.log("Would redirect to chat with:",e),alert("Development mode: Would open chat with ".concat(e)))}catch(e){console.error("Failed to open chat:",e),b("Failed to open chat. Please try again.")}},[]),F=(0,s.useCallback)(async()=>{t("authenticating"),b(null);try{var e;if(!i.M6.isInstalled()){o({walletAddress:"0x"+Math.random().toString(16).slice(2,42),username:"dev_user_"+Math.random().toString(36).slice(2,8),isVerified:!1}),t("verifying");return}let a=await fetch("/api/nonce");if(!a.ok)throw Error("Failed to get nonce");let r=(await a.json()).nonce,{finalPayload:s}=await i.M6.commandsAsync.walletAuth({nonce:r,expirationTime:new Date(Date.now()+6048e5),notBefore:new Date(Date.now()-864e5),statement:"Sign in to Mindalike to meet verified humans!"});if("error"===s.status)throw Error("Wallet authentication failed");let n=await fetch("/api/verify-siwe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:s,nonce:r})});if(!n.ok)throw Error("Failed to verify signature");let{isValid:l,address:d,username:c}=await n.json();if(!l)throw Error("Invalid signature");o({walletAddress:d,username:c||(null===(e=i.M6.user)||void 0===e?void 0:e.username)||"unknown",isVerified:!1}),t("verifying")}catch(e){console.error("Wallet auth error:",e),b(e instanceof Error?e.message:"Authentication failed"),t("error")}},[]),I=async()=>{b(null);try{if(!i.M6.isInstalled()){a&&o({...a,isVerified:!0}),t("verified");return}let r="verifyuser",{finalPayload:s}=await i.M6.commandsAsync.verify({action:r,signal:(null==a?void 0:a.walletAddress)||"",verification_level:i.fZ.Orb});if("error"===s.status)switch(s.code){case"verification_rejected":throw Error("Verification was rejected. Please try again.");case"credential_unavailable":throw Error("You need to verify at an Orb first.");case"max_verifications_reached":throw Error("Maximum verifications reached for this action.");default:throw Error(s.message||"Verification failed")}let n=await fetch("/api/verify-worldid",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payload:s,action:r,signal:null==a?void 0:a.walletAddress})});if(!n.ok)throw Error("Failed to verify proof");if(!(await n.json()).verified)throw Error("Verification failed");a&&o({...a,isVerified:!0});try{if(null==a?void 0:a.walletAddress){let t=await fetch("/api/matches/today?wallet=".concat(encodeURIComponent(a.walletAddress)));if(t.ok){var e;let a=await t.json();L(null!==(e=a.count)&&void 0!==e?e:0)}}}catch(e){}t("verified")}catch(e){console.error("World ID verification error:",e),b(e instanceof Error?e.message:"Verification failed")}},O=()=>{if(!(null==a?void 0:a.username)||!a.walletAddress){b("Please authenticate first");return}if(C>=5){t("payment_required");return}t("queuing"),b(null),z(a.username)};return(0,s.useEffect)(()=>()=>{S.current&&S.current.close(),A.current&&clearTimeout(A.current)},[]),(0,r.jsxs)("div",{className:"min-h-screen bg-bg-1 flex flex-col",children:[(0,r.jsxs)("header",{className:"px-4 sm:px-6 py-4 flex items-center justify-between border-b border-border-primary bg-bg-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.default,{src:"/mindalike-logo.svg",alt:"Mindalike logo",width:36,height:36,className:"h-8 w-8 md:h-9 md:w-9",priority:!0}),(0,r.jsx)("span",{className:"text-xl font-display font-bold gradient-text",children:"Mindalike"})]}),a&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-body-sm text-text-secondary",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(a.isVerified?"bg-success":"bg-yellow-500")}),(0,r.jsx)("span",{className:"truncate max-w-[100px] font-medium",children:a.username})]})]}),(0,r.jsxs)("main",{className:"flex-1 flex flex-col items-center justify-center px-4 sm:px-6 pb-8 pt-8 space-y-6 md:space-y-8",children:["landing"===e&&(0,r.jsx)(m,{isWorldApp:w,onStart:F}),"authenticating"===e&&(0,r.jsx)(h,{message:"Authenticating..."}),"verifying"===e&&(0,r.jsx)(u,{onVerify:I,error:c}),"verified"===e&&(0,r.jsx)(x,{username:(null==a?void 0:a.username)||"",remainingFree:W,onFindMatch:O}),("queuing"===e||"matching"===e)&&(0,r.jsx)(f,{position:g,remainingFree:W,onCancel:()=>{S.current&&(S.current.send(JSON.stringify({type:"leave_queue"})),S.current.close()),A.current&&clearTimeout(A.current),t("verified"),j(0)}}),"matched"===e&&l&&(0,r.jsx)(y,{matchedUsername:l.matchedUsername,countdown:k,onChatNow:()=>P(l.matchedUsername),onFindAnother:()=>{d(null),M(5),O()}}),"payment_required"===e&&a&&(0,r.jsx)(v,{walletAddress:a.walletAddress,remainingFree:W,onClose:()=>t("verified"),onPaymentSuccess:()=>{L(e=>Math.max(0,e-5)),t("verified")},setError:b}),"error"===e&&(0,r.jsx)(p,{message:c||"An error occurred",onRetry:()=>{b(null),t((null==a?void 0:a.isVerified)?"verified":a?"verifying":"landing")}})]}),(0,r.jsx)("footer",{className:"px-4 sm:px-6 py-4 text-center text-body-sm text-text-tertiary border-t border-border-primary bg-bg-2",children:(0,r.jsx)("p",{children:"Powered by World ID • Only verified humans"})})]})}function m(e){let{isWorldApp:t,onStart:a}=e;return(0,r.jsxs)("div",{className:"text-center max-w-md mx-auto w-full space-y-6 md:space-y-8",children:[(0,r.jsxs)("div",{className:"relative w-32 h-32 md:w-40 md:h-40 mx-auto",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-brand-primary rounded-full opacity-20 animate-ping"}),(0,r.jsx)("div",{className:"absolute inset-2 bg-brand-primary rounded-full opacity-30 animate-pulse"}),(0,r.jsx)("div",{className:"relative w-full h-full bg-gradient-to-br from-brand-primary to-brand-heavy rounded-full flex items-center justify-center glow-hero animate-float",children:(0,r.jsx)("svg",{className:"w-16 h-16 md:w-20 md:h-20 text-text-inverted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),(0,r.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[(0,r.jsxs)("h1",{className:"text-display-xl font-display font-bold text-text-primary",children:["Meet ",(0,r.jsx)("span",{className:"gradient-text",children:"Verified"})," Humans"]}),(0,r.jsx)("p",{className:"text-body-lg text-text-secondary leading-relaxed max-w-sm mx-auto",children:"Connect with real people, verified by World ID. No bots, no fakes — just genuine human connections."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(o,{onClick:a,variant:"primary",size:"lg",className:"w-full",leftIcon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),children:"Get Started"}),!t&&(0,r.jsx)(d,{variant:"bordered",padding:"sm",className:"bg-amber-50 border-amber-200",children:(0,r.jsx)("p",{className:"text-body-sm text-amber-800",children:"⚠️ For the best experience, open this app in World App"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center pt-6 md:pt-8",children:[(0,r.jsxs)(d,{variant:"bordered",padding:"sm",className:"bg-bg-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-brand-subtle/30 rounded-full flex items-center justify-center mx-auto mb-2",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-brand-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,r.jsx)("span",{className:"text-body-sm text-text-secondary font-medium",children:"Verified"})]}),(0,r.jsxs)(d,{variant:"bordered",padding:"sm",className:"bg-bg-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-brand-subtle/30 rounded-full flex items-center justify-center mx-auto mb-2",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-brand-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,r.jsx)("span",{className:"text-body-sm text-text-secondary font-medium",children:"Private"})]}),(0,r.jsxs)(d,{variant:"bordered",padding:"sm",className:"bg-bg-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-brand-subtle/30 rounded-full flex items-center justify-center mx-auto mb-2",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-brand-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,r.jsx)("span",{className:"text-body-sm text-text-secondary font-medium",children:"Instant"})]})]})]})}function h(e){let{message:t}=e;return(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"spinner mx-auto"}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:t})]})}function u(e){let{onVerify:t,error:a}=e;return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-brand-primary to-brand-heavy rounded-full flex items-center justify-center mx-auto shadow-brand-primary",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-text-inverted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"Verify You're Human"}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:"To ensure everyone on Mindalike is a real person, please verify with your World ID."})]}),a&&(0,r.jsx)(d,{variant:"bordered",padding:"sm",className:"bg-red-50 border-red-200",children:(0,r.jsx)("p",{className:"text-body-sm text-destructive",children:a})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(o,{onClick:t,variant:"primary",size:"lg",className:"w-full",leftIcon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),children:"Verify with World ID"}),(0,r.jsx)("p",{className:"text-body-sm text-text-tertiary",children:"Requires Orb verification for human uniqueness"})]})]})}function x(e){let{username:t,remainingFree:a,onFindMatch:s}=e;return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-success to-green-600 rounded-full flex items-center justify-center mx-auto shadow-lg animate-float",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-text-inverted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"You're Verified! ✨"}),(0,r.jsxs)("p",{className:"text-body-md text-text-secondary",children:["Welcome, ",(0,r.jsx)("span",{className:"font-semibold text-brand-primary",children:t})]}),(0,r.jsx)("p",{className:"text-body-sm text-text-tertiary",children:"You can now connect with other verified humans around the world."}),(0,r.jsxs)("p",{className:"text-body-sm text-text-tertiary",children:[a,"/5 free matches left today"]})]}),(0,r.jsx)(o,{onClick:s,variant:"primary",size:"lg",className:"w-full animate-glow",leftIcon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),children:"Find a Match"})]})}function f(e){let{position:t,remainingFree:a,onCancel:s}=e;return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsxs)("div",{className:"relative w-32 h-32 mx-auto",children:[(0,r.jsx)("div",{className:"pulse-ring",style:{width:"100%",height:"100%"}}),(0,r.jsx)("div",{className:"pulse-ring",style:{width:"100%",height:"100%",animationDelay:"0.5s"}}),(0,r.jsx)("div",{className:"pulse-ring",style:{width:"100%",height:"100%",animationDelay:"1s"}}),(0,r.jsx)("div",{className:"relative w-full h-full bg-gradient-to-br from-brand-primary to-brand-heavy rounded-full flex items-center justify-center shadow-brand-primary",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-text-inverted animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"Finding Your Match..."}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:"Looking for another verified human"}),(0,r.jsxs)("p",{className:"text-body-sm text-text-tertiary",children:[a,"/5 free matches left today"]}),t>0&&(0,r.jsxs)("p",{className:"text-body-sm text-brand-primary font-medium",children:["Queue position: ",t]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 text-text-tertiary",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-brand-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),(0,r.jsx)(o,{onClick:s,variant:"secondary",size:"md",className:"w-full",children:"Cancel"})]})}function y(e){let{matchedUsername:t,countdown:a,onChatNow:s,onFindAnother:n}=e;return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsxs)("div",{className:"relative w-32 h-32 mx-auto",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-success rounded-full opacity-20 animate-ping"}),(0,r.jsx)("div",{className:"relative w-full h-full bg-gradient-to-br from-success to-green-600 rounded-full flex items-center justify-center shadow-lg",children:(0,r.jsx)("svg",{className:"w-16 h-16 text-text-inverted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"Match Found! \uD83C\uDF89"}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:"You've been matched with"}),(0,r.jsx)("p",{className:"text-heading-lg font-display font-bold text-brand-primary",children:t}),(0,r.jsxs)("p",{className:"text-body-sm text-text-tertiary",children:["Redirecting to World Chat in ",a,"s..."]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(o,{onClick:s,variant:"primary",size:"lg",className:"w-full",leftIcon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),children:"Chat Now"}),(0,r.jsx)(o,{onClick:n,variant:"secondary",size:"md",className:"w-full",children:"Find Another Match"})]})]})}function p(e){let{message:t,onRetry:a}=e;return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-destructive to-red-600 rounded-full flex items-center justify-center mx-auto shadow-lg",children:(0,r.jsx)("svg",{className:"w-12 h-12 text-text-inverted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"Oops!"}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:t})]}),(0,r.jsx)(o,{onClick:a,variant:"primary",size:"lg",className:"w-full",leftIcon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),children:"Try Again"})]})}function v(e){let{walletAddress:t,remainingFree:a,onClose:n,onPaymentSuccess:l,setError:c}=e,[m,h]=(0,s.useState)(!1),u=async()=>{h(!0),c(null);try{var e,a,r;if(!i.M6.isInstalled()){c("MiniKit is not available in this environment."),h(!1);return}let s=crypto.randomUUID().replace(/-/g,"");if(!(await fetch("/api/payments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reference_id:s,wallet_address:t})})).ok){c("Failed to initiate payment. Please try again."),h(!1);return}let n={reference:s,to:"0x98f85f5ff0d253665a576773fffbf66d4e043004",tokens:[{symbol:null!==(r=null===(e=i.M6.Tokens)||void 0===e?void 0:e.WLD)&&void 0!==r?r:"WLD",token_amount:i.M6.tokenToDecimals?i.M6.tokenToDecimals(1,null===(a=i.M6.Tokens)||void 0===a?void 0:a.WLD).toString():"1"}],description:"Mindalike - Unlock more matches"},{finalPayload:o}=await i.M6.commandsAsync.pay(n);if("success"===o.status){let e=await fetch("/api/payments/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reference_id:s,transaction_id:o.transaction_id,wallet_address:t})}),a=await e.json();e.ok&&a.success?l():c(a.error||"Payment could not be verified. Please try again.")}else c("Payment was cancelled or failed.")}catch(e){console.error("Payment error",e),c("Payment failed. Please try again.")}finally{h(!1)}};return(0,r.jsxs)(d,{variant:"elevated",className:"max-w-sm mx-auto w-full text-center space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h2",{className:"text-heading-lg font-display font-bold text-text-primary",children:"You've reached your free limit"}),(0,r.jsx)("p",{className:"text-body-md text-text-secondary",children:"You've used your 5 free matches today. Pay 1 WLD to unlock 5 more matches."}),(0,r.jsxs)("p",{className:"text-body-sm text-text-tertiary",children:["Current free matches left today: ",a,"/5"]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(o,{variant:"primary",size:"lg",className:"w-full",onClick:u,isLoading:m,children:"Pay 1 WLD"}),(0,r.jsx)(o,{variant:"secondary",size:"md",className:"w-full",onClick:n,disabled:m,children:"Maybe later"})]})]})}}},function(e){e.O(0,[666,486,971,117,744],function(){return e(e.s=6954)}),_N_E=e.O()}]);